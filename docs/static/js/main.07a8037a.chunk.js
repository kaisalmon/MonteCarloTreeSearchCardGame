(this["webpackJsonpcard-game-ai"]=this["webpackJsonpcard-game-ai"]||[]).push([[0],{120:function(e,t,r){e.exports=function(){return new Worker(r.p+"53da978fa4c4c5ad2c1e.worker.js")}},121:function(e,t,r){"use strict";r.r(t);var o=r(1),i=r.n(o),s=r(8),a=r.n(s),n=(r(50),r(51),r(2)),l=r.n(n);class c{constructor(e){this.value=void 0,this.value=e}resolveValue(e,t,r){return this.value}}class d{applyEffectNoThrow(e,t,r){try{return this.applyEffect(e,t,r)}catch(o){if(!h.isFizzle(o))throw o;return o.returnState}}}class p{constructor(e,t,r){this.template=void 0,this.regex=void 0,this.slots=void 0,this.factory=void 0,this.template=t;const o=t.toLowerCase().replace(/%\w+\s+/g,"(.*\\s+|)?").replace(/%\w+/g,"(.*|)?");this.regex=new RegExp("^"+o+"$"),this.factory=r,this.slots=[...this.template.matchAll(/%(\w+)/gi)].map((e=>e[1])),p.templates[e].push(this)}static parse(e,t){const r=(t||"").trim(),o=p.templates[e].filter((e=>r.toLowerCase().match(e.regex)));if(0===o.length)throw new Error(`Invalid text for slot ${e}: ${r}`);const i=[],s=o.map((e=>{try{const t=r.toLowerCase().match(e.regex),o=t?t.splice(1):[],i=e.slots.map(((e,t)=>p.parse(e,o[t])));return e.factory(...i)}catch(t){return void i.push(t)}})).filter((e=>e));if(0===s.length){const e=l.a.uniq(i.map((e=>e.message)));throw e.length>1?new Error(e.join("; ")):i[0]}const[a]=s;if(!a)throw Error();return a}static clear(){this.templates={Eff:[],ChoiceAction:[],Player:[],N:[],Cond:[],Ability:[],Demos:[],Position:[]}}}p.templates={Eff:[],Player:[],N:[],Cond:[],ChoiceAction:[],Ability:[],Demos:[],Position:[]};class h extends Error{constructor(e){super("Effect Fizzle!"),this.isFizzle=!0,this.returnState=void 0,this.returnState=e}static isFizzle(e){return e.isFizzle}}class u{constructor(e){this.cardNumber=void 0,this.cardNumber=e}preEffect(e,t){const r=e[t],o=[...r.hand],{isFirstTurn:i}=e;return o.splice(o.indexOf(this.cardNumber),1),{...e,[t]:{...r,popularity:r.popularity-0,hand:o}}}postEffect(e,t){return{...e,cardPlayedThisTurn:!0,endRoundAfterThisTurn:!1,[t]:{...e[t],discardPile:[this.cardNumber,...e[t].discardPile]}}}play(e,t,r){const o=1===e.activePlayer?"playerOne":"playerTwo";try{const t=this.preEffect(e,o),i=this.applyEffect(t,o,r);return this.postEffect(i,o)}catch(i){if(!h.isFizzle(i))throw i;return this.postEffect(i.returnState,o)}}}class y extends u{getName(){return this.name}getText(){return this.text}constructor(e,t,r,o){super(o),this.effect=void 0,this.name=void 0,this.text=void 0,this.effect=e,this.text=t,this.name=r}applyEffect(e,t,r){const o={playerKey:t};return this.effect.applyEffect(e,o,r)}}class f extends u{getName(){return this.name}getText(){return this.text}constructor(e,t,r,o){super(o),this.choiceAction=void 0,this.name=void 0,this.text=void 0,this.choiceAction=e,this.text=t,this.name=r}applyEffect(e,t,r){return{...e,step:"choice",cardBeingPlayed:this.cardNumber}}postEffect(e,t){return e}static is(e){return!!e&&e.hasOwnProperty("choiceAction")}}class v extends u{getName(){return this.name}getText(){return this.text}constructor(e,t,r,o){super(o),this.ability=void 0,this.name=void 0,this.text=void 0,this.ability=e,this.text=t,this.name=r}applyEffect(e){return e}postEffect(e,t){return{...e,cardPlayedThisTurn:!0,endRoundAfterThisTurn:!1,[t]:{...e[t],board:[this.cardNumber,...e[t].board]}}}static isItemCard(e){return e.hasOwnProperty("ability")}}const w={1:"All demographics shift towards the hearts extreme",2:"All demographics shift towards the diamonds extreme",3:"All demographics shift towards the clubs extreme",4:"All demographics shift towards the spades extreme",5:"You shift towards the hearts extreme. Gain one popularity",6:"You shift towards the spades extreme. Your opponent loses one popularity",7:"You shift towards the diamonds extreme. Draw a card",8:"You shift towards the clubs extreme. Your opponent discards a random card",9:"Gain two popularity",10:"Lose one popularity, your followers shift towards you",11:"gain one popularity, your followers shift away from you",13:"You shift towards the center",14:"Your followers shift towards your opponent, then their followers shift towards you",15:"Discard a random card, then shift towards your opponent",16:"Shift away from your opponent, then you draw a card"},m={30:"Choose a player. That player draws 2 cards and loses 2 popularity",31:"Choose an extreme. All demographics shift towards that extreme",32:"Choose an extreme. Shift towards that extreme",33:"Choose an extreme. Gain one popularity and shift towards that extreme"};function b(e,t){return l.a.chain([1,2,3]).flatMap((r=>Object.entries(e).map((([e,o])=>t(o,e,r))))).keyBy("cardNumber").value()}var g=function(){if(Object.values(p.templates).some((e=>0===e.length)))throw new Error("Text Templates not setup");return{...b(w,((e,t,r)=>{const o=p.parse("Eff",e),i=parseInt(t)+r/10;return new y(o,e,`Card #${t}`,i)})),...b(m,((e,t,r)=>{const o=p.parse("ChoiceAction",e),i=parseInt(t)+r/10;return new f(o,e,`Card #${t}`,i)}))}},x=r(36),P=r.n(x);r(37);P()();let j;!function(e){e.IN_PLAY="IN_PLAY",e.LOSE="RED_WIN",e.WIN="BLUE_WIN",e.DRAW="DRAW"}(j||(j={}));var E=r(12),O=r.n(E);class T extends d{constructor(e,t,r,o){super(),this.target=void 0,this.from=void 0,this.to=void 0,this.n=void 0,this.target=e,this.from=t,this.to=r,this.n=o}applyEffect(e,t,r){let o=e;for(let i=0;i<this.n;i++)o=this.transfer(o,t,r);return o}transfer(e,t,r){const o=this.target.resolveValue(e,t,r),i=e[o],s=[...i[this.from]],a=[...i[this.to]];if(0===s.length||"hand"===this.to&&a.length>ee.MAX_HAND_SIZE)throw new h(e);const n=Math.floor(Math.random()*s.length);return a.push(...s.splice(n,1)),{...e,[o]:{...i,[this.to]:a,[this.from]:s}}}}class C extends T{constructor(e,t){super(e,"deck","hand",t)}transfer(e,t,r){const o=super.transfer(e,t,r),i=this.target.resolveValue(e,t,r);return r.processEvent(o,"player_draws",{player:i,cardNumbers:l.a.xor(o[i].hand,e[i].hand),from:"deck"})}}class S extends d{constructor(e,t){super(),this.a=void 0,this.b=void 0,this.a=e,this.b=t}applyEffect(e,t,r){const o=this.a.applyEffect(e,t,r);return this.b.applyEffect(o,t,r)}}class A extends d{constructor(e,t,r){super(),this.target=void 0,this.amount=void 0,this.field=void 0,this.target=e,this.amount=t,this.field=r}applyEffect(e,t,r){const{field:o}=this,i=this.target.resolveValue(e,t,r);return{...e,[i]:{...e[i],[o]:e[i][o]+this.amount}}}}class N extends d{constructor(e,t){super(),this.eff=void 0,this.condition=void 0,this.eff=e,this.condition=t}applyEffect(e,t,r){return this.condition.resolveValue(e,t,r)?this.eff.applyEffect(e,t,r):e}}class k{constructor(e,t,r){this.target=void 0,this.n=void 0,this.mapping=void 0,this.target=e,this.n=t,this.mapping=r}resolveValue(e,t,r){const o=e[this.target.resolveValue(e,t,r)];return this.mapping(o)<this.n}}class M{constructor(e,t){this.abilityType="onEventAbility",this.eventType=void 0,this.eff=void 0,this.eventType=e,this.eff=t}trigger(e,t,r,o){const i={...r,...(null===t||void 0===t?void 0:t.player)&&{lastPlayer:t.player},eventType:this.eventType,eventParams:t};return this.eff.applyEffect(e,i,o)}static isOnEventAbility(e,t){return"onEventAbility"===e.abilityType&&e.eventType===t}}class I extends M{constructor(e,t,r){super(e,t),this.filter=void 0,this.filter=r}trigger(e,t,r,o){return this.filter.resolveValue(e,r,o)!=t.player?e:super.trigger(e,t,r,o)}}var Y=r(38),B=r.n(Y);class R{constructor(e){this.eff=void 0,this.eff=e}applyEffect(e,t,r,o){return this.eff.applyEffect(t,{...r,lastPlayer:1===e.choice?"playerOne":"playerTwo"},o)}getChoices(e,t,r){return[{type:"choice",choice:1},{type:"choice",choice:2}]}}class W extends d{constructor(e){super(),this.target=void 0,this.target=e}applyEffect(e,t,r){const o=this.target.resolveValue(e,t,r);return{...e,[o]:{...e[o],position:this.shift(e[o].position,e,t,r)}}}}class V extends W{constructor(e,t,r){super(e),this.point=void 0,this.stepSize=void 0,this.point=t,this.stepSize=r}static shiftTowardsPoint(e,t,r,o,i,s){const a=e.resolveValue(o,i,s),n=a.x-r.x,l=a.y-r.y,c=Math.sqrt(n*n+l*l),d=t>0?Math.min(c,t):t,p=e=>Math.max(-1,Math.min(1,e));return{x:p(r.x+n/c*d),y:p(r.y+l/c*d)}}shift(e,t,r,o){return V.shiftTowardsPoint(this.point,this.stepSize,e,t,r,o)}}class X extends d{constructor(e){super(),this.demos=void 0,this.demos=e}applyEffect(e,t,r){const o=this.demos.resolveValue(e,t,r);return{...e,demographics:e.demographics.map(((i,s)=>o.includes(s)?this.shift(i,e,t,r):i))}}}class z extends X{constructor(e,t,r){super(e),this.point=void 0,this.stepSize=void 0,this.point=t,this.stepSize=r}shift(e,t,r,o){return V.shiftTowardsPoint(this.point,this.stepSize,e,t,r,o)}}class D{resolveValue(e,t){return e.demographics.map(((e,t)=>t))}}class _{constructor(e){this.playerTarget=void 0,this.playerTarget=e}resolveValue(e,t,r){const o="playerOne"===this.playerTarget.resolveValue(e,t,r)?1:2;return e.demographics.map(((e,t)=>({demo:e,i:t}))).filter((({demo:t})=>r.getDemographicVote(e,t)===o)).map((({i:e})=>e))}}class L{constructor(e){this.playerTarget=void 0,this.playerTarget=e}resolveValue(e,t,r){return e[this.playerTarget.resolveValue(e,t,r)].position}}const H={hearts:{x:1,y:-1},clubs:{x:-1,y:-1},diamonds:{x:1,y:1},spades:{x:-1,y:1}};const F={1:H.hearts,2:H.clubs,3:H.diamonds,4:H.spades},K={hearts:1,clubs:2,diamonds:3,spades:4};class ${constructor(e){this.eff=void 0,this.eff=e}applyEffect(e,t,r,o){return this.eff.applyEffect(t,{...r,lastExtreme:F[e.choice]},o)}getChoices(e,t,r){return[{type:"choice",choice:1},{type:"choice",choice:2},{type:"choice",choice:3},{type:"choice",choice:4}]}}class U{resolveValue(e,t){if(!t.lastExtreme)throw new h(e);return t.lastExtreme}}function q(e){return e.hasOwnProperty("target")}const G={resolveValue:(e,t)=>(t.lastPlayer=t.playerKey,t.playerKey)},J={resolveValue(e,t){const r="playerOne"===t.playerKey?"playerTwo":"playerOne";return t.lastPlayer=r,r}},Z={resolveValue:(e,t)=>t.lastPlayer||t.playerKey};var Q=function(){new p("N","a",(()=>1));for(let e=0;e<25;e++)new p("N",B.a.toWords(e),(()=>e)),new p("N",`${e}`,(()=>e));new p("Player","yourself",(()=>G)),new p("Player","you",(()=>G)),new p("Player","your",(()=>G)),new p("Player","your opponent",(()=>J)),new p("Player","your opponent'?s",(()=>J)),new p("Player","the other player",(()=>J)),new p("Player","they",(()=>Z)),new p("Player","them",(()=>Z)),new p("Player","their",(()=>Z)),new p("Player","that player",(()=>Z)),new p("Player","",(()=>Z)),new p("Eff","%Eff and %Eff",((e,t)=>new S(e,t))),new p("Eff","%Eff, and %Eff",((e,t)=>new S(e,t))),new p("Eff","%Eff, %Eff",((e,t)=>new S(e,t))),new p("Eff","%Eff\\. %Eff",((e,t)=>new S(e,t))),new p("Eff","%Eff then %Eff",((e,t)=>new S(e,t))),new p("Eff","%Eff, then %Eff",((e,t)=>new S(e,t))),new p("Eff","%Player draws? %N cards?",((e,t)=>new C(e,t))),new p("Eff","%Player draws? up to %N cards?",((e,t)=>new C(e,t))),new p("Eff","%Player discards? %N random cards?",((e,t)=>new T(e,"hand","discardPile",t))),new p("Eff","%Player discards? the top card (?:from|of) (?:their|your) deck",(e=>new T(e,"deck","discardPile",1))),new p("Eff","%Player discards? %N cards? from the top of (?:their|your) deck",((e,t)=>new T(e,"deck","discardPile",t))),new p("Eff","%Player draws? %N random cards? from (?:their|your) discard pile",((e,t)=>new T(e,"discardPile","hand",t))),new p("Eff","%Player loses? %N popularity",((e,t)=>new A(e,-t,"popularity"))),new p("Eff","%Player gains? %N popularity",((e,t)=>new A(e,t,"popularity"))),function(){const e=(e,t)=>(q(e)&&q(t)&&t.target===Z&&(t.target=e.target,e.target=Z),new N(e,t));new p("Eff","%Eff, if %Cond",e),new p("Eff","%Eff if %Cond",e),new p("Eff","If %Cond, %Eff",((e,t)=>new N(t,e)))}(),new p("Cond","%Player\\s?(?:has|have) less than %N cards in (?:their|your) hand",((e,t)=>new k(e,t,(e=>e.hand.length)))),new p("Cond","%Player\\s?(?:has|have) less than %N popularity",((e,t)=>new k(e,t,(e=>e.popularity)))),[{eventType:"player_draws",text:"draws? a card"},{eventType:"player_take_damage",text:"takes damage"}].forEach((({eventType:e,text:t})=>{new p("Ability",`When(?:ever) %Player ${t}, %Eff`,((t,r)=>new I(e,r,t))),new p("Ability",`When(?:ever) a player ${t}, %Eff`,(t=>new M(e,t)))})),new p("Ability","At the start of each turn, %Eff",(e=>new M("turn_start",e))),new p("Ability","At the start of your turn, %Eff",(e=>new I("turn_start",e,G))),new p("Demos","All demographics",(()=>new D)),new p("Demos","%Player followers",(e=>new _(e))),Object.entries(H).forEach((([e,t])=>{new p("Position",`the ${e} extreme`,(()=>new c(t)))})),new p("Position","the cente?re?",(()=>new c({x:0,y:0}))),new p("Position","%Player",(e=>new L(e))),new p("Eff","%Demos shift towards %Position",((e,t)=>new z(e,t,1/21))),new p("Eff","%Demos shift away from %Position",((e,t)=>new z(e,t,-1/21))),new p("ChoiceAction","Choose a player. %Eff",(e=>new R(e))),new p("Eff","%Player shift towards %Position",((e,t)=>new V(e,t,2/21))),new p("Eff","%Player shift away from %Position",((e,t)=>new V(e,t,-2/21))),new p("ChoiceAction","Choose an extreme. %Eff",(e=>new $(e))),new p("Position","that extreme",(e=>new U))};class ee extends class{applyMoveChain(e,t){return Array.isArray(t)?t.reduce(((e,t)=>this.applyMove(e,t)),e):this.applyMove(e,t)}}{constructor(e,t,r){super(),this.cardIndex=void 0,this.deckOne=void 0,this.deckTwo=void 0,this.cardIndex=e,this.deckOne=t||Object.keys(this.cardIndex).map((e=>parseFloat(e))),this.deckTwo=r||this.deckOne}applyMove(e,t){if("end"===t.type)return this.onTurnEnd(e);if("play"===t.type)return this.applyCardPlay(e,t.cardNumber);if("discard"===t.type)return this.applyCardDiscard(e,t.cardNumber);if("choice"===t.type)return this.applyChoiceMove(e,t);throw new Error("Unknown move")}getSensibleMoves(e){if(1===e.roundsUntilElection&&e.endRoundAfterThisTurn){const t=this.getVotes(e);if(t[e.activePlayer]>t[3-e.activePlayer])return[{type:"end"}]}return e.cardPlayedThisTurn?[{type:"end"}]:this.getCardMoves(e).filter((t=>{const r=Array.isArray(t)?t[0].cardNumber:t.cardNumber;if(!this.cardIndex[r])throw new Error("Can't find card "+r);const{effect:o}=this.cardIndex[r];if("ConditionalEffect"!==(null===o||void 0===o?void 0:o.constructor.name))return!0;const{condition:i}=o,s=1===e.activePlayer?"playerOne":"playerTwo";return i.resolveValue(e,{playerKey:s},this)}))}getDemographicVote(e,t){const r=e.playerOne.popularity,o=e.playerTwo.popularity,i=Math.pow(e.playerOne.position.x-t.x,2)+Math.pow(e.playerOne.position.y-t.y,2),s=o/100-(Math.pow(e.playerTwo.position.x-t.x,2)+Math.pow(e.playerTwo.position.y-t.y,2)),a=r/100-i;return a>s&&a>0?1:s>a&&s>0?2:void 0}getVotes(e){const t=l.a.chain(e.demographics).map((t=>this.getDemographicVote(e,t))).filter(l.a.identity).countBy().value();return{1:t[1]||0,2:t[2]||0}}getStatus(e){if(e.roundsUntilElection>0)return j.IN_PLAY;const t=this.getVotes(e);return t[1]>t[2]?j.WIN:t[1]<t[2]?j.LOSE:j.DRAW}getValidMoves(e){if(void 0!==e.cardBeingPlayed){const t=1===e.activePlayer?"playerOne":"playerTwo",r=this.cardIndex[e.cardBeingPlayed];if(!f.is(r))throw new Error("Not a choice card!");return r.choiceAction.getChoices(e,{playerKey:t},this)}return"draw"===e.step?this.getDiscardMoves(e):[{type:"end"},...this.getCardMoves(e)]}newGame(){const e={hand:[],discardPile:[],board:[]},t={activePlayer:1,roundsUntilElection:4,demographics:new Array(50).fill(0).map((()=>({x:Math.random()+Math.random()-1,y:Math.random()+Math.random()-1}))),endRoundAfterThisTurn:!1,cardPlayedThisTurn:!1,step:"play",isFirstTurn:!0,playerOne:{...e,deck:this.deckOne,popularity:10,position:{x:.2,y:0}},playerTwo:{deck:this.deckTwo,position:{x:-.2,y:0},popularity:10,...e}},r=new C(G,ee.MAX_HAND_SIZE-1),o=new C(G,ee.MAX_HAND_SIZE),i=r.applyEffect(t,{playerKey:"playerOne"},this);return o.applyEffect(i,{playerKey:"playerTwo"},this)}print({playerOne:e,playerTwo:t,...r}){console.log(O.a.white(JSON.stringify(r,null,4))),console.log(O.a.blue(JSON.stringify(e,null,4))),console.log(O.a.red(JSON.stringify(t,null,4)))}randomizeHiddenInfo(e){const t=1===e.activePlayer?"playerTwo":"playerOne",r=[...e[t].deck,...e[t].hand],o=[];for(let i=0;i<e[t].hand.length;i++){const e=Math.floor(Math.random()*r.length);o.push(...r.splice(e,1))}return{...e,[t]:{...e[t],hand:o,deck:r}}}getCardMoves(e){if("play"!=e.step)return[];const t=1===e.activePlayer?"playerOne":"playerTwo",r=e[t];return l.a.flatMap(r.hand,(r=>{const o={type:"play",cardNumber:r},i=this.cardIndex[r];if(f.is(i)){return i.choiceAction.getChoices(e,{playerKey:t},this).map((e=>[o,e]))}return[o]}))}getDiscardMoves(e){if("draw"!=e.step)return[];return(1===e.activePlayer?e.playerOne:e.playerTwo).hand.map((e=>({type:"discard",cardNumber:e})))}onTurnEnd(e){const t=1===e.activePlayer?2:1,r=1===t?"playerOne":"playerTwo",o=e.endRoundAfterThisTurn,i={...o?this.onRoundEnd(e):e,step:"play",cardPlayedThisTurn:!1,isFirstTurn:!1,endRoundAfterThisTurn:!e.cardPlayedThisTurn&&!o,activePlayer:t};return this.processEvent(i,"turn_start",{player:r})}applyCardPlay(e,t){return this.cardIndex[t].play(e,t,this)}applyCardDiscard(e,t){const r=1===e.activePlayer?"playerOne":"playerTwo",o=e[r],i=[...o.hand],s=[...o.discardPile];return s.push(...i.splice(i.indexOf(t),1)),{...e,step:i.length>ee.MAX_HAND_SIZE?"draw":"play",[r]:{...o,hand:i,discardPile:s}}}getHeuristic(e){const t=this.getVotes(e),r=t[1],o=t[2];return r===o?0:(r-o)/(o+r)}processEvent(e,t,r){if(this.getStatus(e)!=j.IN_PLAY)return e;let o=e;return["playerOne","playerTwo"].forEach((i=>{e[i].board.map((e=>this.cardIndex[e])).filter((e=>v.isItemCard(e))).map((e=>e.ability)).filter((e=>M.isOnEventAbility(e,t))).forEach((e=>{try{o=e.trigger(o,r,{playerKey:i},this)}catch(t){if(!h.isFizzle(t))throw t;o=t.returnState}}))})),o}applyChoiceMove(e,t){const r=1===e.activePlayer?"playerOne":"playerTwo",o=this.cardIndex[e.cardBeingPlayed];if(!f.is(o))throw new Error(`${e.cardBeingPlayed} Not a choice card!`);return{...(()=>{try{return o.choiceAction.applyEffect(t,e,{playerKey:r},this)}catch(i){if(!h.isFizzle(i))throw i;return i.returnState}})(),step:"play",cardBeingPlayed:void 0}}onRoundEnd(e){const t=e=>({...e,hand:[]}),r={...e,endRoundIfNoCardPlayedThisTurn:!1,roundsUntilElection:e.roundsUntilElection-1,playerOne:t(e.playerOne),playerTwo:t(e.playerTwo)};if(1===e.roundsUntilElection)return r;const o=new C(G,6);return o.applyEffectNoThrow(o.applyEffectNoThrow(r,{playerKey:"playerTwo"},this),{playerKey:"playerOne"},this)}getActiveActionChoice(e){if(void 0===e.cardBeingPlayed)return;const t=this.cardIndex[e.cardBeingPlayed];if(!f.is(t))throw new Error("Not a choice card!");return t.choiceAction}}ee.MAX_HAND_SIZE=6;var te=r(0);const re={boxSizing:"border-box",position:"absolute",background:"orange",width:14,zIndex:1,left:10,top:90,marginBottom:100,transformOrigin:"top",display:"flex",flexDirection:"column-reverse",alignItems:"center",cursor:"none",pointerEvents:"none"},oe={position:"relative",top:10,borderLeft:"20px solid transparent",borderRight:"20px solid transparent",borderTop:"20px solid orange",cursor:"none",pointerEvents:"none"};var ie=()=>{const[e,t]=i.a.useState(100),[r,s]=i.a.useState(45),a=i.a.useRef(null),n={height:e,transform:`rotate(${r}rad)`};return Object(o.useEffect)((()=>{const e=e=>{if(!a.current)return;const r=a.current.getBoundingClientRect(),o=e.clientX-r.x-20,i=e.clientY-r.y- -45,n=Math.atan2(-o,i),l=Math.sqrt(o*o+i*i);s(n),t(l)};return window.addEventListener("mousemove",e),()=>window.removeEventListener("mousemove",e)}),[a]),Object(te.jsx)("div",{ref:a,children:Object(te.jsx)("div",{style:{...re,...n},children:Object(te.jsx)("div",{style:oe})})})};function se(e){const[t,r]=Object(o.useState)(0),[i,s]=Object(o.useState)(!1);return Object(te.jsx)("span",{onMouseOver:()=>{if(!i){const t=window.setTimeout((()=>{e.handleHoverTrigger()}),e.delay);s(!0),r(t)}},onMouseOut:()=>{clearTimeout(t),s(!1),e.handleHoverCancel()},children:e.children})}const ae={backgroundColor:"white",borderWidth:"1px",borderColor:"black",borderStyle:"solid",fontSize:11,borderRadius:3,width:80,height:120,marginLeft:5,marginTop:5,marginRight:5,marginBottom:5,top:0,display:"inline-block",transition:"transform 0.3s, margin 0.35s ease-in 0.3s, top 0.4s ease-in-out 0.5s",cursor:"not-allowed",overflow:"hidden",zIndex:0},ne={fontWeight:"bold",fontSize:16},le={...ae,color:"blue",borderColor:"black",transform:"scale(1.3)",marginLeft:-40,marginRight:-40,zIndex:1},ce={...ae,borderColor:"red",borderWidth:3,cursor:"pointer"},de={...ae,borderColor:"blue",borderWidth:3,cursor:"pointer"},pe={top:160},he={top:-160},ue={backgroundColor:"darkgray",color:"darkgray",transform:"rotate3d(0,1,0,0.5turn)"},ye={transform:"scale(0)"},fe={position:"relative",transition:"transform 0.3s, margin 0.35s ease-in 0.3s, top 0.4s ease-in-out 0.5s",display:"inline-block",top:0,zIndex:1};var ve=e=>{const[t,r]=i.a.useState(e.onBoard&&!e.beingPlayed);i.a.useEffect((()=>{if(e.onBoard&&e.beingPlayed){const e=setTimeout((()=>{r(!0)}),800);return()=>window.clearTimeout(e)}if(e.onBoard&&!e.beingPlayed){const e=setTimeout((()=>{r(!1)}),800);return()=>window.clearTimeout(e)}}));const{card:o,beingPlayed:s}=e,a=e.canBeDiscarded?ce:e.canBePlayed?de:t?ye:{},n=e.beingPlayed&&e.isOpponent?pe:e.beingPlayed&&!e.isOpponent?he:{},l=e.isHidden?ue:{},c=e.canBeDiscarded||e.canBePlayed?e.onClick:()=>{};return Object(te.jsx)(se,{delay:400,handleHoverTrigger:()=>{e.canBePlayed&&e.setPreview({type:"play",cardNumber:e.card.cardNumber})},handleHoverCancel:()=>{e.setPreview()},children:Object(te.jsxs)("div",{style:{...fe,...n},children:[Object(te.jsxs)("div",{style:{...s?le:ae,...a,...l},onClick:c,children:[Object(te.jsx)("div",{style:ne,children:o.getName()}),Object(te.jsx)("div",{children:o.getText()})]}),e.beingPlayed&&f.is(o)&&!e.isOpponent&&Object(te.jsx)(ie,{})]})})},we=(r(22),r.p+"static/media/bg.e49eda7f.png"),me=r(9),be=r(39);var ge=function({component:e,propList:t,...r}){const[i,s]=Object(o.useState)(r);return Object(o.useEffect)((()=>{setTimeout((()=>{const e={};let o=!1;for(let s of t){const t=i[s],a=r[s]-t;Math.abs(a)>.005&&(o=!0);const n=t+a/5;e[s]=n}o&&s(e)}),100)}),[r,i]),e({...r,...i})};const xe={height:500,width:500,border:"1px solid black",position:"relative",margin:10,overflow:"hidden",marginBottom:160},Pe={width:30,height:30,borderRadius:"100%",border:"1px solid black",position:"absolute",top:-15,left:-15,transition:"background 0.3s, transform 0.3s"},je={width:10,height:10,borderRadius:"20%",border:"1px solid black",position:"absolute",top:-5,left:-5,transition:"background 0.3s, transform 0.3s",pointerEvents:"none"},Ee={border:"1px solid black",height:25,overflow:"hidden",color:"white"};function Oe({x:e,y:t}){return`translate(${250*(e+1)}px,${250*(t+1)}px)`}const Te=me.Shaders.create({helloBlue:{frag:me.GLSL`
precision highp float;
varying vec2 uv;
uniform float bluePop;
uniform float blueX;
uniform float blueY;
uniform float redPop;
uniform float redX;
uniform float redY;
uniform float pbluePop;
uniform float pblueX;
uniform float pblueY;
uniform float predPop;
uniform float predX;
uniform float predY;
float distSquared( vec2 A, vec2 B )
{
    vec2 C = A - B;
    return dot( C, C );
}

void main() {
  vec2 bluePos = vec2(blueX, 1.0-blueY);
  vec2 redPos = vec2(redX, 1.0-redY);
  vec2 pBluePos = vec2(pblueX, 1.0-pblueY);
  vec2 pRedPos = vec2(predX, 1.0-predY);
  
  float blueScore = bluePop/400.0 - distSquared(bluePos, uv);
  float redScore = redPop/400.0 - distSquared(redPos, uv);
  float pBlueScore = pbluePop/400.0 - distSquared(pBluePos, uv);
  float pRedScore = predPop/400.0 - distSquared(pRedPos, uv);
  
  bool blueWins = blueScore > 0.0 && blueScore > redScore ;
  bool redWins = redScore > 0.0 && blueScore < redScore ;
  bool pBlueWins = pBlueScore > 0.0 && pBlueScore > pRedScore;
  bool pRedWins = pRedScore > 0.0 && pBlueScore < redScore ;
  
  bool noWins = !blueWins && !redWins && !pBlueWins && !pRedWins;
  
  vec3 redColor = vec3(0.8,0.1,0.1);
  vec3 blueColor = vec3(0.15,0.15,0.8);
  vec3 grayColor = vec3(.7,0.7,0.7);
  
  vec3 col = (redWins||pRedWins) && !pBlueWins ? redColor :
           (blueWins||pBlueWins) && !pRedWins  ? blueColor :
           grayColor;
    
  vec3 gains = (!redWins && pRedWins) || (!blueWins && pBlueWins) ? vec3(0.2) : vec3(0);
 vec3 losses = (redWins && !pRedWins) || (blueWins && !pBlueWins) ? vec3(0.2) : vec3(0);
  
  gl_FragColor = vec4(col + gains - losses , 1.0);
}`}}),Ce=e=>{const{blueX:t,redPop:r,redX:o,bluePop:i,blueY:s,redY:a,pblueX:n,predPop:l,predX:c,pbluePop:d,pblueY:p,predY:h}=e;return Object(te.jsxs)(te.Fragment,{children:[Object(te.jsx)("img",{src:we,style:{position:"absolute"}}),Object(te.jsx)(be.Surface,{width:500,height:500,style:{mixBlendMode:"multiply"},children:Object(te.jsx)(me.Node,{shader:Te.helloBlue,uniforms:{blueX:t/2+.5,blueY:s/2+.5,bluePop:i,redX:o/2+.5,redY:a/2+.5,redPop:r,pblueX:n/2+.5,pblueY:p/2+.5,pbluePop:d,predX:c/2+.5,predY:h/2+.5,predPop:l}})})]})};class Se extends i.a.Component{render(){return Object(te.jsx)(ge,{component:Ce,propList:["blueX","blueY","bluePop","redX","redY","redPop","pblueX","pblueY","pbluePop","predX","predY","predPop"],blueX:this.props.blueX,blueY:this.props.blueY,bluePop:this.props.bluePop,redX:this.props.redX,redY:this.props.redY,redPop:this.props.redPop,pblueX:this.props.pblueX,pblueY:this.props.pblueY,pbluePop:this.props.pbluePop,predX:this.props.predX,predY:this.props.predY,predPop:this.props.predPop})}}const Ae=({redVotes:e,blueVotes:t})=>Object(te.jsxs)("div",{style:{display:"flex",width:200},children:[Object(te.jsx)("div",{style:{flexGrow:t,background:"blue",...Ee},children:Math.round(t)}),Object(te.jsx)("div",{style:{flexGrow:e,background:"red",...Ee},children:Math.round(e)})]});var Ne=e=>{var t,r;const{gamestate:{playerOne:o,playerTwo:i},onChoiceClick:s,game:a}=e,n=e.game.getVotes(e.gamestate),l=(null===(t=a.getActiveActionChoice(e.gamestate))||void 0===t?void 0:t.constructor)===R,c=(null===(r=a.getActiveActionChoice(e.gamestate))||void 0===r?void 0:r.constructor)===$,d=Object(te.jsx)(se,{delay:400,handleHoverTrigger:()=>{l&&e.setPreview({type:"choice",choice:1})},handleHoverCancel:()=>{e.setPreview()},children:Object(te.jsx)("div",{className:l?"glow":"",style:{...Pe,background:"blue",transform:Oe(e.gamestate.playerOne.position)},onClick:()=>l&&s({type:"choice",choice:1})})}),p=Object(te.jsx)(se,{delay:400,handleHoverTrigger:()=>{l&&e.setPreview({type:"choice",choice:2})},handleHoverCancel:()=>{e.setPreview()},children:Object(te.jsx)("div",{className:l?"glow":"",style:{...Pe,background:"red",transform:Oe(e.gamestate.playerTwo.position)},onClick:()=>l&&s({type:"choice",choice:2})})});return Object(te.jsxs)("div",{style:{display:"flex",justifyContent:"space-evenly"},children:[Object(te.jsxs)("div",{style:xe,children:[Object(te.jsx)(Se,{bluePop:o.popularity,blueX:o.position.x,blueY:o.position.y,redPop:i.popularity,redX:i.position.x,redY:i.position.y,pbluePop:e.previewState?e.previewState.playerOne.popularity:o.popularity,pblueX:e.previewState?e.previewState.playerOne.position.x:o.position.x,pblueY:e.previewState?e.previewState.playerOne.position.y:o.position.y,predPop:e.previewState?e.previewState.playerTwo.popularity:i.popularity,predX:e.previewState?e.previewState.playerTwo.position.x:i.position.x,predY:e.previewState?e.previewState.playerTwo.position.y:i.position.y}),d,p,["playerOne","playerTwo"].map((t=>Object(te.jsx)("div",{style:{...Pe,borderColor:"white",pointerEvents:"none",opacity:!e.previewState||e.previewState[t].position.x==e.gamestate[t].position.x&&e.previewState[t].position.y==e.gamestate[t].position.y?0:1,transform:e.previewState?Oe(e.previewState[t].position):Oe(e.gamestate[t].position)}}))),e.gamestate.demographics.map((({x:t,y:r},o)=>{var i;const s=e.game.getDemographicVote(e.gamestate,{x:t,y:r}),a=1===s?"blue":2===s?"red":"gray",n={transform:Oe({x:t,y:r}),background:a},l=null===(i=e.previewState)||void 0===i?void 0:i.demographics[o],c={transform:l?Oe(l):n.transform,opacity:!l||l.x===t&&l.y===r?0:.5,borderColor:"white",background:a};return Object(te.jsxs)(te.Fragment,{children:[Object(te.jsx)("div",{style:{...je,...n}},o),Object(te.jsx)("div",{style:{...je,...c}},`${o}_preview`)]})})),c&&Object.entries(H).map((([t,r])=>Object(te.jsx)(se,{delay:400,handleHoverTrigger:()=>{e.setPreview({type:"choice",choice:K[t]})},handleHoverCancel:()=>{e.setPreview()},children:Object(te.jsx)("div",{className:"glow",onClick:()=>s({type:"choice",choice:K[t]}),style:{position:"absolute",backgroundColor:"rgba(255, 128, 0, 0.5)",top:-75,left:-75,width:150,height:150,borderRadius:500,transform:Oe(r)}})})))]}),Object(te.jsxs)("div",{style:{textAlign:"center"},children:["Election in",Object(te.jsx)("div",{style:{fontSize:"150%",fontWeight:"bold"},children:e.gamestate.roundsUntilElection}),"Rounds",Object(te.jsx)("div",{children:e.gamestate.cardPlayedThisTurn?"Card has been Played this turn":"-"}),Object(te.jsx)("div",{children:e.gamestate.endRoundAfterThisTurn?"Round will end if turn ended now":"-"}),Object(te.jsx)(ge,{component:Ae,propList:["blueVotes","redVotes"],blueVotes:n[1]||0,redVotes:n[2]||0})]})]})},ke=r(18),Me=r(43);const Ie={border:"1px solid black",fontSize:10,borderRadius:3,width:40,height:60,margin:5,display:"inline-block"},Ye={maxHeight:200,fontSize:10,textAlign:"left",width:150,overflowY:"auto"};var Be=e=>{const{label:t,cards:r}=e,{getArrowProps:o,getTooltipProps:i,setTooltipRef:s,setTriggerRef:a,visible:n}=Object(Me.a)({interactive:!0,delayHide:100});return Object(te.jsxs)(te.Fragment,{children:[Object(te.jsxs)("div",{style:Ie,ref:a,children:[t,Object(te.jsx)("div",{children:r.length})]}),n&&Object(te.jsxs)("div",{ref:s,...i({className:"tooltip-container"}),children:[0===r.length&&Object(te.jsx)("i",{children:"Empty"}),Object(te.jsx)("ul",{style:Ye,children:r.map(((e,t)=>Object(te.jsxs)("li",{children:[Object(te.jsx)("b",{children:"string"===typeof e?e:e.getName()})," ","string"!==typeof e&&e.getText()]},t)))}),Object(te.jsx)("div",{...o({className:"tooltip-arrow"})})]})]})};const Re={display:"flex",alignItems:"center",placeContent:"center"},We={...Re,background:"gold"},Ve={display:"inline-flex",minWidth:400,justifyContent:"center"},Xe={fontSize:60,position:"relative"},ze={position:"absolute",bottom:25,left:18,width:20,fontSize:16,color:"white",textAlign:"center"},De=({onCardClick:e,setPreview:t,game:r,player:o,isActive:i,isHidden:s,lastmove:a,gamestate:n})=>{const l=a&&"play"===a.type?[a.cardNumber]:[],c=[...o.hand,...l].sort(((e,t)=>e-t));ke.a,o.board.map((e=>Object(te.jsx)("div",{children:Object(te.jsx)(ve,{onClick:()=>{},setPreview:()=>{},isOpponent:s,isHidden:!1,card:r.cardIndex[e],canBePlayed:!1,canBeDiscarded:!1,beingPlayed:!1,onBoard:!0})},e+" "+r.cardIndex[e].getName())));return Object(te.jsxs)("div",{style:i?We:Re,children:[Object(te.jsxs)("div",{style:Xe,children:["\u2764",Object(te.jsx)("div",{style:ze,children:o.popularity})]}),Object(te.jsx)(ke.a,{style:{...Ve},children:c.map((a=>Object(te.jsx)("div",{style:{position:"relative"},children:Object(te.jsx)(ve,{onClick:()=>e(a),setPreview:t,isOpponent:s,isHidden:s&&!l.includes(a),card:r.cardIndex[a],canBePlayed:i&&!s&&"play"===n.step&&!l.includes(a),canBeDiscarded:i&&!s&&"draw"===n.step&&!l.includes(a),beingPlayed:l.includes(a),onBoard:o.board.includes(a)})},a+" "+r.cardIndex[a].getName())))}),Object(te.jsx)(Be,{label:"deck",cards:o.deck.map((e=>s?"?":r.cardIndex[e]))}),Object(te.jsx)(Be,{label:"discard",cards:o.discardPile.map((e=>r.cardIndex[e]))})]})};var _e=e=>{const{gamestate:t,game:r,lastmove:o,onCardClick:i,onChoiceClick:s,setPreview:a,previewState:n}=e;return Object(te.jsxs)(te.Fragment,{children:[Object(te.jsxs)("div",{children:["Step: ",t.step]}),Object(te.jsx)(De,{onCardClick:()=>{},setPreview:()=>{},game:r,gamestate:t,player:t.playerTwo,lastmove:2===t.activePlayer?o:void 0,isActive:2===t.activePlayer,isHidden:!0}),Object(te.jsx)(Ne,{gamestate:t,game:r,previewState:n,onChoiceClick:s,setPreview:a}),Object(te.jsx)(De,{onCardClick:i,setPreview:a,game:r,gamestate:t,player:t.playerOne,lastmove:1===t.activePlayer?o:void 0,isActive:1===t.activePlayer,isHidden:!1})]})},Le=r(41),He=r.n(Le).a,Fe=r(42),Ke=r.n(Fe);const $e=new He;var Ue=function(){Q();const e=Object(o.useMemo)((()=>g()),[]),t=Object(o.useMemo)((()=>new ee(e)),[e]),[r,s]=i.a.useState({state:t.newGame()}),a=Object(o.useMemo)((()=>t.getStatus(r.state)),[t,r.state]),[n,l]=i.a.useState("..."),[c,d]=i.a.useState(),[p,h]=i.a.useState(!1);i.a.useEffect((()=>{let e=0;return e=window.setTimeout((async()=>{if(2===r.state.activePlayer&&!p&&t.getStatus(r.state)===j.IN_PLAY){var e;h(!0);const o="end"===(null===(e=r.lastMove)||void 0===e?void 0:e.type)?400:1e3,[{mood:i,move:a}]=await Promise.all([$e.processData(r.state),Ke()(o)]),n=t.applyMoveChain(r.state,a);l(i),h(!1),d(void 0),s({state:n,lastMove:Array.isArray(a)?a[0]:a})}}),0),()=>window.clearTimeout(e)}),[r,t,p]);const u=(Array.isArray(r.lastMove)?r.lastMove[0]:r.lastMove)||{type:"end"},y=t.getValidMoves(r.state).find((e=>!Array.isArray(e)&&"end"===e.type));return Object(te.jsxs)("div",{className:"App",children:[a!==j.IN_PLAY&&Object(te.jsx)("h1",{children:a}),Object(te.jsx)(_e,{gamestate:r.state,game:t,lastmove:u,previewState:c,onCardClick:e=>{if(a!==j.IN_PLAY)return;const o=(i=r.state,n=e,"draw"==i.step?{type:"discard",cardNumber:n}:{type:"play",cardNumber:n});var i,n;const l=t.applyMove(r.state,o);d(void 0),s({state:l,lastMove:o})},onChoiceClick:e=>{if(a!==j.IN_PLAY)return;const o=t.applyMove(r.state,e);d(void 0),s({state:o,lastMove:e})},setPreview:e=>d(e&&t.applyMove(r.state,e))}),Object(te.jsx)("button",{disabled:a!==j.IN_PLAY||2===r.state.activePlayer||!y,onClick:()=>{const e={type:"end"},o=t.applyMove(r.state,e);s({state:o,lastMove:e})},children:r.state.endRoundAfterThisTurn?"End Round":"End Turn"}),Object(te.jsx)("div",{children:n}),p&&"loading"]})};var qe=e=>{e&&e instanceof Function&&r.e(3).then(r.bind(null,126)).then((({getCLS:t,getFID:r,getFCP:o,getLCP:i,getTTFB:s})=>{t(e),r(e),o(e),i(e),s(e)}))};a.a.render(Object(te.jsx)(i.a.StrictMode,{children:Object(te.jsx)(Ue,{})}),document.getElementById("root")),qe()},41:function(e,t,r){var o,i=r(119).wrap,s=r(120);e.exports=function e(){return this instanceof e?i(s()):o||(o=i(s()))}},50:function(e,t,r){},51:function(e,t,r){}},[[121,1,2]]]);
//# sourceMappingURL=main.07a8037a.chunk.js.map